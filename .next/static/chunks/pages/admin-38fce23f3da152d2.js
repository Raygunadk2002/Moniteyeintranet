(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{577:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return t(4298)}])},4820:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});var a=t(5893);t(7294);var l=t(1163);function r(e){let{children:s}=e,t=(0,l.useRouter)(),r=e=>"/"===e?"/"===t.pathname:t.pathname.startsWith(e);return(0,a.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"w-64 bg-gray-900 text-white flex flex-col",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-700",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-white",children:"Moniteye"}),(0,a.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Intranet Dashboard"})]}),(0,a.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:[{name:"Dashboard",href:"/",icon:"\uD83C\uDFE0"},{name:"Tasks",href:"/tasks",icon:"\uD83D\uDCCB"},{name:"Calendar",href:"/calendar",icon:"\uD83D\uDCC5"},{name:"Admin",href:"/admin",icon:"⚙️"},{name:"About",href:"/about",icon:"ℹ️"}].map(e=>(0,a.jsxs)("a",{href:e.href,className:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ".concat(r(e.href)?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"),children:[(0,a.jsx)("span",{className:"text-lg",children:e.icon}),(0,a.jsx)("span",{className:"font-medium",children:e.name})]},e.name))}),(0,a.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:"AK"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-white text-sm font-medium",children:"Alex Keal"}),(0,a.jsx)("p",{className:"text-gray-400 text-xs",children:"Admin"})]})]})})]}),(0,a.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:s})]})}},4298:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n}});var a=t(5893),l=t(7294),r=t(4820);function n(){var e;let[s,t]=(0,l.useState)(null),[n,i]=(0,l.useState)(!1),[d,c]=(0,l.useState)(null),[o,m]=(0,l.useState)(!1),[x,h]=(0,l.useState)(null),u=async()=>{if(!s)return;i(!0),c(null);let e=new FormData;e.append("file",s);try{let s=await fetch("/api/upload-revenue",{method:"POST",body:e}),t=await s.json();s.ok?c({success:!0,message:t.message,recordsProcessed:t.recordsProcessed,monthsGenerated:t.monthsGenerated,totalRevenue:t.totalRevenue,detectedFormat:t.detectedFormat,dateRange:t.dateRange,summary:t.summary}):c({success:!1,error:t.error,suggestions:t.suggestions})}catch(e){c({success:!1,error:"Upload failed. Please try again."})}finally{i(!1)}},g=async()=>{m(!0),h(null);try{let e=await fetch("/api/test-supabase"),s=await e.json();h(s)}catch(e){h({success:!1,error:e instanceof Error?e.message:"Unknown error"})}finally{m(!1)}};return(0,a.jsx)(r.Z,{children:(0,a.jsx)("div",{className:"flex-1 bg-gray-50 overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"bg-white border-b border-gray-200 px-6 py-4 -mx-6 -mt-6 mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Admin Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Upload invoice data to update revenue trends"})]}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"\uD83D\uDD27 Database Setup"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-amber-800 mb-2",children:"⚠️ Setup Required"}),(0,a.jsx)("p",{className:"text-sm text-amber-700",children:'Before uploading files, you need to set up the required database tables. Click "Test Database" to check if they exist.'})]}),(0,a.jsx)("button",{onClick:g,disabled:o,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-amber-600 hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 disabled:bg-gray-300 disabled:cursor-not-allowed",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Testing Database..."]}):"Test Database Setup"}),x&&(0,a.jsxs)("div",{className:"rounded-md p-4 ".concat(x.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,a.jsx)("h3",{className:"text-sm font-medium mb-2 ".concat(x.success?"text-green-800":"text-red-800"),children:x.success?"✅ Database Ready":"❌ Database Setup Required"}),(0,a.jsx)("p",{className:"text-sm mb-3 ".concat(x.success?"text-green-700":"text-red-700"),children:x.message}),!x.success&&x.instructions&&(0,a.jsxs)("div",{className:"bg-white rounded border border-red-300 p-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-red-800 mb-2",children:"Setup Instructions:"}),(0,a.jsx)("ol",{className:"text-sm text-red-700 list-decimal list-inside space-y-1",children:x.instructions.map((e,s)=>(0,a.jsx)("li",{children:e},s))}),(0,a.jsxs)("div",{className:"mt-3 p-2 bg-gray-100 rounded text-xs font-mono",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"Copy this file to your Supabase SQL Editor:"}),(0,a.jsx)("p",{className:"text-blue-600",children:"database-schema.sql"})]})]}),x.tables&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-800 mb-2",children:"Table Status:"}),(0,a.jsx)("div",{className:"space-y-1",children:x.tables.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:e.table}),(0,a.jsx)("span",{className:e.success?"text-green-600":"text-red-600",children:e.success?"✓ Ready":"✗ Missing"})]},s))})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"\uD83D\uDCCA Upload Invoice Data"}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"\uD83D\uDD0D Smart Auto-Detection Features"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Automatic column detection:"})," Finds invoice dates and amounts automatically"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Flexible date formats:"}),' Supports DD/MM/YYYY, MM/DD/YYYY, YYYY-MM-DD, "January 15, 2025", etc.']}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Intelligent grouping:"})," Groups individual invoices by month and sums totals"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Multi-language headers:"})," Recognizes date/amount columns in English, Spanish, and more"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Flexible layout:"})," Columns can be in any order (A, B, C, etc.)"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File with Invoice Data"}),(0,a.jsx)("input",{id:"file-upload",name:"file-upload",type:"file",accept:".xlsx,.xls",onChange:e=>{e.target.files&&e.target.files[0]&&(t(e.target.files[0]),c(null))},className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Upload your Excel file containing individual invoice records with dates and amounts"})]}),s&&(0,a.jsx)("div",{className:"bg-gray-50 rounded-md p-3",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,a.jsx)("strong",{children:"Selected file:"})," ",s.name," (",(s.size/1024/1024).toFixed(2)," MB)"]})}),(0,a.jsx)("button",{onClick:u,disabled:!s||n,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:bg-gray-300 disabled:cursor-not-allowed",children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing Invoice Data..."]}):"Upload & Process Invoices"})]}),d&&(0,a.jsx)("div",{className:"mt-6",children:d.success?(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsxs)("h3",{className:"text-sm font-medium text-green-800",children:["✅ ",d.message]}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-green-700",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Processed:"})," ",d.recordsProcessed," individual invoices"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Generated:"})," ",d.monthsGenerated," monthly revenue entries"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total Revenue:"})," \xa3",null===(e=d.totalRevenue)||void 0===e?void 0:e.toLocaleString()]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Date Range:"})," ",d.dateRange]}),d.detectedFormat&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Auto-detected:"})," ",d.detectedFormat]}),d.summary&&(0,a.jsx)("p",{className:"mt-2 font-medium",children:d.summary})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("button",{onClick:()=>window.location.href="/",className:"text-sm bg-green-100 hover:bg-green-200 text-green-800 px-3 py-1 rounded-md",children:"View Updated Dashboard →"})})]})]})}):(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"❌ Upload Failed"}),(0,a.jsx)("p",{className:"text-sm text-red-700 mt-1",children:d.error}),d.suggestions&&d.suggestions.length>0&&(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-red-800",children:"\uD83D\uDCA1 Suggestions:"}),(0,a.jsx)("ul",{className:"text-sm text-red-700 mt-1 list-disc list-inside space-y-1",children:d.suggestions.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]})]})]})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"\uD83D\uDCD6 Supported Excel Formats"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"✅ Date Column Examples:"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-md p-3 text-sm font-mono",children:[(0,a.jsx)("div",{className:"text-green-600",children:"• 2025-01-15"}),(0,a.jsx)("div",{className:"text-green-600",children:"• 15/01/2025"}),(0,a.jsx)("div",{className:"text-green-600",children:"• 01/15/2025"}),(0,a.jsx)("div",{className:"text-green-600",children:"• January 15, 2025"}),(0,a.jsx)("div",{className:"text-green-600",children:"• 15 January 2025"}),(0,a.jsx)("div",{className:"text-green-600",children:"• 15-01-2025"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"✅ Amount Column Examples:"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-md p-3 text-sm font-mono",children:[(0,a.jsx)("div",{className:"text-green-600",children:"• 1250.50"}),(0,a.jsx)("div",{className:"text-green-600",children:"• 850"}),(0,a.jsx)("div",{className:"text-green-600",children:"• 12500.00"}),(0,a.jsx)("div",{className:"text-red-600",children:"• \xa31,250.50 (remove currency)"}),(0,a.jsx)("div",{className:"text-red-600",children:"• $850.00 (remove currency)"})]})]})]}),(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:"\uD83C\uDFAF How It Works:"}),(0,a.jsxs)("ol",{className:"text-sm text-gray-600 space-y-2",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"1. Upload Individual Invoices:"})," Each row should contain one invoice with its date and amount"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"2. Automatic Detection:"})," System finds date and amount columns using smart content analysis"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"3. Monthly Grouping:"})," All invoices are automatically grouped by month (e.g., all January 2025 invoices summed together)"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"4. Dashboard Update:"})," Monthly totals are used to create the revenue trend chart"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"5. Real-time Metrics:"})," Total revenue and growth calculations update automatically"]})]})]}),(0,a.jsxs)("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-md p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:"\uD83D\uDCA1 Pro Tips:"}),(0,a.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1",children:[(0,a.jsx)("li",{children:'• Include headers like "Date", "Invoice Date", "Amount", "Value" for best detection'}),(0,a.jsx)("li",{children:"• Remove currency symbols (\xa3, $, €) from amount columns"}),(0,a.jsx)("li",{children:"• Ensure dates are in a consistent format within the same column"}),(0,a.jsx)("li",{children:"• Use separate columns for dates and amounts (don't combine in one cell)"}),(0,a.jsx)("li",{children:"• System handles mixed date formats and flexible column orders automatically"})]})]})]})]})]})})})}},1163:function(e,s,t){e.exports=t(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=577)}),_N_E=e.O()}]);