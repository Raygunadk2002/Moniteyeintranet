(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[689],{2360:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tasks",function(){return s(9441)}])},4820:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var r=s(5893);s(7294);var a=s(1163);function l(e){let{children:t}=e,s=(0,a.useRouter)(),l=e=>"/"===e?"/"===s.pathname:s.pathname.startsWith(e);return(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,r.jsxs)("div",{className:"w-64 bg-gray-900 text-white flex flex-col",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-700",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-white",children:"Moniteye"}),(0,r.jsx)("p",{className:"text-gray-400 text-sm mt-1",children:"Intranet Dashboard"})]}),(0,r.jsx)("nav",{className:"flex-1 px-4 py-6 space-y-2",children:[{name:"Dashboard",href:"/",icon:"\uD83C\uDFE0"},{name:"Tasks",href:"/tasks",icon:"\uD83D\uDCCB"},{name:"Calendar",href:"/calendar",icon:"\uD83D\uDCC5"},{name:"Admin",href:"/admin",icon:"⚙️"},{name:"About",href:"/about",icon:"ℹ️"}].map(e=>(0,r.jsxs)("a",{href:e.href,className:"flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ".concat(l(e.href)?"bg-blue-600 text-white":"text-gray-300 hover:text-white hover:bg-gray-700"),children:[(0,r.jsx)("span",{className:"text-lg",children:e.icon}),(0,r.jsx)("span",{className:"font-medium",children:e.name})]},e.name))}),(0,r.jsx)("div",{className:"p-4 border-t border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-sm font-medium",children:"AK"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-white text-sm font-medium",children:"Alex Keal"}),(0,r.jsx)("p",{className:"text-gray-400 text-xs",children:"Admin"})]})]})})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:t})]})}},9441:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var r=s(5893),a=s(7294),l=s(8627),i=s(4820);function n(){var e;let[t,s]=(0,a.useState)({id:"main-board",title:"Project Management Board",columns:[]}),[n,o]=(0,a.useState)(!0),[d,c]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[m,h]=(0,a.useState)(!1),[g,b]=(0,a.useState)(""),[p,f]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[v,w]=(0,a.useState)(""),[N,k]=(0,a.useState)(null),[C,E]=(0,a.useState)({title:"",description:"",priority:"Medium",assignee:""}),T=(0,a.useCallback)(async()=>{try{o(!0);let e=await fetch("/api/tasks");if(!e.ok)throw Error("Failed to fetch tasks");let t=await e.json();s({id:"main-board",title:"Project Management Board",columns:t.columns||[]})}catch(e){console.error("Error loading tasks:",e)}finally{o(!1)}},[]);(0,a.useEffect)(()=>{T()},[T]);let D=(0,a.useCallback)(async e=>{let{destination:t,source:r,draggableId:a}=e;if(t){if(t.droppableId===r.droppableId&&t.index===r.index)return;s(e=>{let s={...e},l=s.columns.find(e=>e.id===r.droppableId),i=s.columns.find(e=>e.id===t.droppableId);if(!l||!i)return e;let n=l.tasks.find(e=>e.id===a);if(!n)return e;l.tasks=l.tasks.filter(e=>e.id!==a);let o={...n,column_id:t.droppableId};return i.tasks.splice(t.index,0,o),s});try{if(!(await fetch("/api/tasks",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,column_id:t.droppableId,order_index:t.index})})).ok)throw Error("Failed to update task")}catch(e){console.error("Error updating task:",e),T()}}},[T]),S=(0,a.useCallback)(async()=>{if(C.title.trim()&&g)try{if(!(await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:C.title,description:C.description,priority:C.priority,assignee:C.assignee,tags:[],column_id:g})})).ok)throw Error("Failed to create task");await T(),E({title:"",description:"",priority:"Medium",assignee:""}),c(!1),b("")}catch(e){console.error("Error creating task:",e)}},[C,g,T]),A=(0,a.useCallback)(async()=>{if(v.trim())try{if(!(await fetch("/api/task-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:v})})).ok)throw Error("Failed to create column");await T(),w(""),x(!1)}catch(e){console.error("Error creating column:",e)}},[v,T]),_=(0,a.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete this column? All tasks in this column will be lost."))try{if(!(await fetch("/api/task-columns",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)throw Error("Failed to delete column");await T()}catch(e){console.error("Error deleting column:",e)}},[T]),L=(0,a.useCallback)(async(e,t)=>{if(t.trim())try{if(!(await fetch("/api/task-columns",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,title:t})})).ok)throw Error("Failed to update column");await T(),f(""),j("")}catch(e){console.error("Error updating column:",e)}},[T]),M=(0,a.useCallback)(e=>{k(e),h(!0)},[]),P=(0,a.useCallback)(async()=>{if(N)try{if(!(await fetch("/api/tasks",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:N.id,title:N.title,description:N.description,priority:N.priority,assignee:N.assignee,tags:N.tags})})).ok)throw Error("Failed to update task");await T(),h(!1),k(null)}catch(e){console.error("Error updating task:",e)}},[N,T]),F=(0,a.useCallback)(async e=>{if(window.confirm("Are you sure you want to delete this task?"))try{if(!(await fetch("/api/tasks",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)throw Error("Failed to delete task");await T(),h(!1),k(null)}catch(e){console.error("Error deleting task:",e)}},[T]),O=e=>{switch(e){case"Critical":return"bg-red-100 text-red-800 border-red-200";case"High":return"bg-orange-100 text-orange-800 border-orange-200";case"Medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return n?(0,r.jsx)(i.Z,{children:(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading tasks..."})]})})}):(0,r.jsx)(i.Z,{children:(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:t.title}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage your tasks and track progress • Live data from Supabase"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>x(!0),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2",children:(0,r.jsx)("span",{children:"+ Add Column"})}),(0,r.jsx)("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:(0,r.jsx)("span",{children:"+ Add Task"})}),(0,r.jsx)("button",{onClick:T,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:(0,r.jsx)("span",{children:"↻ Refresh"})})]})]})}),(0,r.jsx)("div",{className:"flex-1 p-6 overflow-hidden",children:(0,r.jsx)(l.Z5,{onDragEnd:D,children:(0,r.jsx)("div",{className:"flex space-x-6 overflow-x-auto pb-4 h-full",children:t.columns.map(e=>(0,r.jsx)(l.bK,{droppableId:e.id,children:(t,s)=>(0,r.jsxs)("div",{ref:t.innerRef,...t.droppableProps,className:"flex-shrink-0 w-80 bg-white rounded-lg border border-gray-200 shadow-sm flex flex-col ".concat(s.isDraggingOver?"bg-blue-50 border-blue-200":""),children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[p===e.id?(0,r.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value),onBlur:()=>L(e.id,y),onKeyDown:t=>{"Enter"===t.key?L(e.id,y):"Escape"===t.key&&(f(""),j(""))},className:"font-semibold text-gray-900 bg-transparent border-none outline-none focus:ring-2 focus:ring-blue-500 rounded px-1",autoFocus:!0}):(0,r.jsx)("h3",{className:"font-semibold text-gray-900 cursor-pointer hover:text-blue-600",onClick:()=>{f(e.id),j(e.title)},title:"Click to edit column title",children:e.title}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"bg-gray-100 text-gray-600 text-sm px-2 py-1 rounded-full",children:e.tasks.length}),(0,r.jsx)("button",{onClick:()=>{b(e.id),c(!0)},className:"text-gray-400 hover:text-gray-600 p-1",title:"Add task",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),(0,r.jsx)("button",{onClick:()=>_(e.id),className:"text-gray-400 hover:text-red-600 p-1",title:"Delete column",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})}),(0,r.jsxs)("div",{className:"p-4 space-y-3 flex-1 overflow-y-auto",children:[e.tasks.map((e,t)=>(0,r.jsx)(l._l,{draggableId:e.id,index:t,children:(t,s)=>(0,r.jsx)("div",{ref:t.innerRef,...t.draggableProps,...t.dragHandleProps,onClick:t=>{s.isDragging||(t.preventDefault(),M(e))},className:"bg-white border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow cursor-pointer ".concat(s.isDragging?"shadow-lg transform rotate-2":""),title:"Click to edit task",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 text-sm leading-tight",children:e.title}),e.description&&(0,r.jsx)("p",{className:"text-gray-600 text-xs leading-relaxed",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[e.priority&&(0,r.jsx)("span",{className:"text-xs px-2 py-1 rounded-full border ".concat(O(e.priority)),children:e.priority}),e.assignee&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs font-medium",children:e.assignee.charAt(0)})}),(0,r.jsx)("span",{className:"text-xs text-gray-600",children:e.assignee})]})]}),e.tags&&e.tags.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:e.tags.map((e,t)=>(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:e},t))})]})})},e.id)),t.placeholder]})]})},e.id))})})}),d&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Task"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title *"}),(0,r.jsx)("input",{type:"text",value:C.title,onChange:e=>E({...C,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter task title",autoFocus:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{value:C.description,onChange:e=>E({...C,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter task description",rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,r.jsxs)("select",{value:C.priority,onChange:e=>E({...C,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"Low",children:"Low"}),(0,r.jsx)("option",{value:"Medium",children:"Medium"}),(0,r.jsx)("option",{value:"High",children:"High"}),(0,r.jsx)("option",{value:"Critical",children:"Critical"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignee"}),(0,r.jsx)("input",{type:"text",value:C.assignee,onChange:e=>E({...C,assignee:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Assign to team member"})]}),!g&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Column *"}),(0,r.jsxs)("select",{value:g,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select a column"}),t.columns.map(e=>(0,r.jsx)("option",{value:e.id,children:e.title},e.id))]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>{c(!1),b(""),E({title:"",description:"",priority:"Medium",assignee:""})},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:S,disabled:!C.title.trim()||!g,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Add Task"})]})]})}),u&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Column"}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Column Title *"}),(0,r.jsx)("input",{type:"text",value:v,onChange:e=>w(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter column title",autoFocus:!0})]})}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>{x(!1),w("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:A,disabled:!v.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Add Column"})]})]})}),m&&N&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Edit Task"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title *"}),(0,r.jsx)("input",{type:"text",value:N.title,onChange:e=>k({...N,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter task title"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,r.jsx)("textarea",{value:N.description||"",onChange:e=>k({...N,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter task description",rows:3})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,r.jsxs)("select",{value:N.priority||"Medium",onChange:e=>k({...N,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"Low",children:"Low"}),(0,r.jsx)("option",{value:"Medium",children:"Medium"}),(0,r.jsx)("option",{value:"High",children:"High"}),(0,r.jsx)("option",{value:"Critical",children:"Critical"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assignee"}),(0,r.jsx)("input",{type:"text",value:N.assignee||"",onChange:e=>k({...N,assignee:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Assign to team member"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags (comma separated)"}),(0,r.jsx)("input",{type:"text",value:(null===(e=N.tags)||void 0===e?void 0:e.join(", "))||"",onChange:e=>k({...N,tags:e.target.value.split(",").map(e=>e.trim()).filter(e=>e.length>0)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., frontend, urgent, bug-fix"})]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,r.jsxs)("p",{children:["Created: ",new Date(N.created_at).toLocaleDateString()]}),(0,r.jsxs)("p",{children:["Last updated: ",new Date(N.updated_at).toLocaleDateString()]})]})]}),(0,r.jsxs)("div",{className:"flex justify-between space-x-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>F(N.id),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Delete Task"}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:()=>{h(!1),k(null)},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,r.jsx)("button",{onClick:P,disabled:!N.title.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Save Changes"})]})]})]})})]})})}}},function(e){e.O(0,[62,824,888,774,179],function(){return e(e.s=2360)}),_N_E=e.O()}]);