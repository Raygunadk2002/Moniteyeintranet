"use strict";(()=>{var e={};e.id=571,e.ids=[571],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,s)=>{Object.defineProperty(s,"l",{enumerable:!0,get:function(){return function e(s,t){return t in s?s[t]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,t)):"function"==typeof s&&"default"===t?s:void 0}}})},4431:(e,s,t)=>{t.r(s),t.d(s,{config:()=>l,default:()=>u,routeModule:()=>d});var a={};t.r(a),t.d(a,{default:()=>c});var r=t(1802),n=t(7153),o=t(6249),i=t(6137);async function c(e,s){try{console.log("Testing database connections...");let e=[];try{let{data:s,error:t}=await i.pR.from("upload_batches").select("id").limit(1);e.push({table:"upload_batches",success:!t,error:t?.message,recordCount:s?.length||0})}catch(s){e.push({table:"upload_batches",success:!1,error:s instanceof Error?s.message:"Unknown error"})}try{let{data:s,error:t}=await i.pR.from("invoices").select("id").limit(1);e.push({table:"invoices",success:!t,error:t?.message,recordCount:s?.length||0})}catch(s){e.push({table:"invoices",success:!1,error:s instanceof Error?s.message:"Unknown error"})}try{let{data:s,error:t}=await i.pR.from("revenue_data").select("id").limit(1);e.push({table:"revenue_data",success:!t,error:t?.message,recordCount:s?.length||0})}catch(s){e.push({table:"revenue_data",success:!1,error:s instanceof Error?s.message:"Unknown error"})}e.every(e=>e.success)?s.status(200).json({success:!0,message:"✅ All database tables are ready! Upload should work now.",tables:e}):s.status(500).json({success:!1,message:"❌ Database tables are missing. Please create them first.",tables:e,instructions:["1. Go to your Supabase Dashboard → SQL Editor","2. Run the SQL script from database-schema.sql","3. Or create the tables manually using the CREATE TABLE statements","4. Test again using this endpoint"]})}catch(e){console.error("Database test error:",e),s.status(500).json({success:!1,error:e instanceof Error?e.message:"Unknown error"})}}let u=(0,o.l)(a,"default"),l=(0,o.l)(a,"config"),d=new r.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/test-database",pathname:"/api/test-database",bundlePath:"",filename:""},userland:a})},6137:(e,s,t)=>{t.d(s,{OQ:()=>o,pR:()=>i});let a=require("@supabase/supabase-js"),r="https://tfskdfkzhqiiamziggoB.supabase.co",n=process.env.SUPABASE_SERVICE_ROLE_KEY,o=(0,a.createClient)(r,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRmc2tkZmt6aHFpaWFtemlnZ29iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk0Nzc3ODksImV4cCI6MjA2NTA1Mzc4OX0.wUR1GCbNEMrjcVRNG0l03Y0uXDgxd1y7wfAIGxSz5kA",{auth:{autoRefreshToken:!0,persistSession:!0},global:{fetch:(e,s={})=>fetch(e,{...s,signal:AbortSignal.timeout(3e4)})}}),i=(0,a.createClient)(r,n,{auth:{autoRefreshToken:!1,persistSession:!1},global:{fetch:(e,s={})=>fetch(e,{...s,signal:AbortSignal.timeout(45e3)})}})},7153:(e,s)=>{var t;Object.defineProperty(s,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,s,t)=>{e.exports=t(145)}};var s=require("../../webpack-api-runtime.js");s.C(e);var t=s(s.s=4431);module.exports=t})();