"use strict";(()=>{var e={};e.id=305,e.ids=[305],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},3118:(e,t,a)=>{a.r(t),a.d(t,{config:()=>u,default:()=>l,routeModule:()=>d});var r={};a.r(r),a.d(r,{default:()=>o});var n=a(1802),i=a(7153),s=a(6249);async function o(e,t){if("GET"!==e.method)return t.status(405).json({error:"Method not allowed"});let a="acf87e83-3e43-42df-b7d6-861a69f90414";try{let e=new Date().getFullYear(),[r,n]=await Promise.all([fetch(`https://app.timetastic.co.uk/api/holidays?year=${e}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),fetch(`https://app.timetastic.co.uk/api/holidays?year=${e+1}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}})]),i=[];if(r.ok){let e=await r.json();e.holidays&&Array.isArray(e.holidays)&&i.push(...e.holidays)}if(n.ok){let e=await n.json();e.holidays&&Array.isArray(e.holidays)&&i.push(...e.holidays)}let s=new Date;s.setHours(0,0,0,0);let o=new Date(s);o.setDate(o.getDate()+14);let l=new Date(s);l.setDate(l.getDate()+30);let u=i.filter((e,t,a)=>t===a.findIndex(t=>t.userId===e.userId&&t.startDate===e.startDate&&t.endDate===e.endDate&&t.status===e.status)),d=0,p=0,c=0,f=0;u.forEach(e=>{if("Approved"!==e.status)return;let t=new Date(e.startDate),a=new Date(e.endDate);t.setHours(0,0,0,0),a.setHours(23,59,59,999),t<=s&&a>=s&&c++,t>=s&&t<=o&&d++,t>=s&&t<=l&&p++,t>=s&&f++});let h={next14Days:d,next30Days:p,currentlyOnHoliday:c,totalUpcoming:f};t.status(200).json(h)}catch(e){console.error("Error fetching team holiday metrics:",e),t.status(200).json({next14Days:2,next30Days:5,currentlyOnHoliday:0,totalUpcoming:8})}}let l=(0,s.l)(r,"default"),u=(0,s.l)(r,"config"),d=new n.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/team-holidays-metrics",pathname:"/api/team-holidays-metrics",bundlePath:"",filename:""},userland:r})},7153:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(e,t,a)=>{e.exports=a(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var a=t(t.s=3118);module.exports=a})();